<!DOCTYPE html><html lang="es"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Unihouser — Prospectos</title>
<link rel="stylesheet" href="css/style.css">
<style>
  .steps{display:flex;gap:8px;flex-wrap:wrap;margin:6px 0 14px}
  .step{padding:8px 12px;border-radius:999px;border:1px solid #2b343a;background:#0f1214;opacity:.7}
  .step.active{opacity:1;border-color:var(--accent)}
  .gate{margin:12px 0;padding:12px;border:1px dashed #2b343a;border-radius:12px}
  .gate h3{margin:0 0 8px}
  .ghostlink{background:none;border:none;color:var(--accent);cursor:pointer;text-decoration:underline;padding:0}
  .actions .small{padding:8px 10px;font-weight:600}
  .muted{color:var(--muted)}
</style>
</head><body>
<header class="topbar">
  <div class="container flex between center">
    <div class="brand flex center"><div class="title">Unihouser — CRM & BuyBox</div></div>
    <nav class="nav">
      <a href="evaluar.html">Evaluar</a>
      <a href="evaluaciones.html">Evaluaciones</a>
      <a href="prospectos.html" class="active">Prospectos</a>
      <a href="dashboard.html">Dashboard</a>
      <a href="configuracion.html">Configuración</a>
    </nav>
  </div>
</header>

<main class="container">
<section class="card">
  <h2>Prospectos</h2>

  <!-- Barra de fases -->
  <div class="steps" id="steps">
    <div class="step" data-phase="F1">F1 · Contacto</div>
    <div class="step" data-phase="F2">F2 · Contrato</div>
    <div class="step" data-phase="F3">F3 · Búsqueda</div>
    <div class="step" data-phase="F4">F4 · Arras</div>
    <div class="step" data-phase="F5">F5 · Notaría</div>
  </div>

  <input type="hidden" id="p_idx" value="-1">

  <!-- ===== F1: CONTACTO ===== -->
  <div class="gate" id="gateF1">
    <h3>F1 · Contacto</h3>
    <div class="row three">
      <div class="field"><label>Nombre y apellidos (opcional)</label><input id="p_nombre" placeholder="Nombre y apellidos"></div>
      <div class="field"><label>Email</label><input id="p_email" placeholder="email@dominio.com"></div>
      <div class="field"><label>Teléfono</label><input id="p_tel" placeholder="644 300 200"></div>
    </div>
    <div class="row three">
      <div class="field"><label>Recordatorio contactar el</label><input id="p_recordatorio" type="date"></div>
      <div class="field"><label>Subestado</label>
        <select id="p_sub_f1">
          <option>Contacto recibido</option>
          <option>Pendiente contactar</option>
          <option>Contactado</option>
          <option>Descartado (F1)</option>
        </select>
      </div>
      <div class="field"><label>&nbsp;</label>
        <div class="actions">
          <button class="btn small" id="f1_email">Enviar email inicial</button>
          <button class="btn small" id="f1_pdf">Generar resumen F1</button>
          <button class="btn primary small" id="toF2">Pasar a F2 · Contrato</button>
        </div>
      </div>
    </div>
    <small class="muted">Mínimo para guardar en F1: email o teléfono.</small>
  </div>

  <!-- ===== F2: CONTRATO ===== -->
  <div class="gate" id="gateF2" hidden>
    <h3>F2 · Contrato</h3>
    <!-- Datos personales completos -->
    <div class="row three">
      <div class="field"><label>DNI</label><input id="p_dni" placeholder="00000000X"></div>
      <div class="field"><label>Dirección</label><input id="p_dir" placeholder="C/ Ejemplo 1, 3ºA"></div>
      <div class="field"><label>Localidad</label><input id="p_loc_res" placeholder="Oviedo"></div>
    </div>

    <!-- Objetivos / financiación esenciales para contrato -->
    <div class="row three">
      <div class="field"><label>Tipo de alquiler</label>
        <select id="p_pref_tipo"><option>Tradicional</option><option>Habitaciones</option></select>
      </div>
      <div class="field"><label>Objetivo principal</label>
        <select id="p_obj_tipo">
          <option value="bruta">Rentabilidad bruta (%)</option>
          <option value="neta">Rentabilidad neta (%)</option>
          <option value="flujo">Flujo de caja (€/mes)</option>
        </select>
      </div>
      <div class="field"><label>Valor objetivo</label><input id="p_obj_val" placeholder="7,5 o 300"></div>
    </div>

    <div class="row three">
      <div class="field"><label>Presupuesto TOTAL (€)</label><input id="p_budget" data-money placeholder="150.000"></div>
      <div class="field"><label>Incluir honorarios PSI</label>
        <select id="p_incl_honor"><option value="si">Sí</option><option value="no">No</option></select>
      </div>
      <div class="field"><label>Máx. compra activo (auto)</label><input id="p_max_compra" data-money disabled></div>
    </div>

    <div class="actions">
      <button class="btn small" id="f2_pdf">PDF resumen reunión</button>
      <button class="btn small" id="f2_mail_ok">Email “OK, te envío contrato”</button>
      <button class="btn small" id="f2_mail_no">Email de despedida</button>
      <button class="btn primary" id="f2_contrato">Preparar contrato</button>
      <button class="btn" id="toF1">Volver a F1</button>
      <button class="btn primary" id="toF3">Pasar a F3 · Búsqueda</button>
    </div>
  </div>

  <!-- ===== F3: BÚSQUEDA ===== -->
  <div class="gate" id="gateF3" hidden>
    <h3>F3 · Búsqueda</h3>
    <div class="row three">
      <div class="field"><label>Localidades objetivo</label><input id="p_locs_obj" placeholder="Oviedo, Gijón, Avilés"></div>
      <div class="field"><label>Nº activos deseados</label><input id="p_n_activos" inputmode="numeric" placeholder="1"></div>
      <div class="field"><label>Mes inicio búsqueda</label><input id="p_inicio" type="month"></div>
    </div>
    <div class="row three">
      <div class="field"><label>Mes fin búsqueda (máx +5)</label><input id="p_fin" type="month"></div>
      <div class="field"><label>¿Sin ascensor?</label><select id="p_no_asc"><option value="no">No</option><option value="si">Sí</option></select></div>
      <div class="field"><label>Altura máxima</label><input id="p_alt_max" inputmode="numeric" placeholder="3"></div>
    </div>
    <div class="row three">
      <div class="field"><label>¿Admite bajos?</label><select id="p_bajos"><option value="no">No</option><option value="si">Sí</option></select></div>
      <div class="field"><label>Acepta reforma</label><select id="p_reforma"><option>No</option><option>Lavado de cara</option><option>Integral</option></select></div>
      <div class="field"><label>Observaciones</label><input id="p_notes" placeholder="Preferencias, restricciones, etc."></div>
    </div>
    <div class="actions">
      <button class="btn small" id="f3_enviar_props">Email: Propuesta enviada</button>
      <button class="btn small" id="f3_reserva">Marcar “Reserva activada”</button>
      <button class="btn primary" id="toF4">Pasar a F4 · Arras</button>
      <button class="btn" id="backF2">Volver a F2</button>
    </div>
  </div>

  <!-- ===== F4: ARRAS ===== -->
  <div class="gate" id="gateF4" hidden>
    <h3>F4 · Arras</h3>
    <p class="muted">Antes de la firma: IBI, nota simple, actas de comunidad.</p>
    <div class="actions">
      <button class="btn small" id="f4_pendientes">Marcar pendientes de arras</button>
      <button class="btn small" id="f4_firmadas">Marcar arras firmadas</button>
      <button class="btn primary" id="toF5">Pasar a F5 · Notaría</button>
      <button class="btn" id="backF3">Volver a F3</button>
    </div>
  </div>

  <!-- ===== F5: NOTARÍA ===== -->
  <div class="gate" id="gateF5" hidden>
    <h3>F5 · Notaría</h3>
    <div class="row three">
      <div class="field"><label>Fecha de notaría</label><input id="p_notaria_fecha" type="date"></div>
      <div class="field"><label>Subestado</label>
        <select id="p_sub_f5"><option>Notaría fijada</option><option>Completado</option></select>
      </div>
    </div>
    <div class="actions">
      <button class="btn primary" id="f5_cerrar">Cerrar operación</button>
      <button class="btn" id="backF4">Volver a F4</button>
    </div>
  </div>

  <!-- Acciones globales -->
  <div class="actions" style="margin-top:16px">
    <button class="btn primary" id="p_save" type="button">Guardar</button>
    <button class="btn ghost" id="p_clear" type="button">Limpiar</button>
  </div>
  <div id="p_toast" class="toast success" hidden>✅ Prospecto guardado</div>

  <div class="hr"></div>

  <!-- LISTADO -->
  <div class="section">
    <h3>Listado</h3>
    <div class="row three">
      <div class="field"><label>Filtrar por fase</label>
        <select id="f_fase">
          <option value="">Todas</option>
          <option value="F1">F1</option><option value="F2">F2</option>
          <option value="F3">F3</option><option value="F4">F4</option><option value="F5">F5</option>
        </select>
      </div>
      <div class="field"><label>Filtrar por tipo</label>
        <select id="f_tipo"><option value="">Todos</option><option>Tradicional</option><option>Habitaciones</option></select>
      </div>
      <div class="field"><label>Buscar</label><input id="f_q" placeholder="Nombre / localidad"></div>
    </div>
  </div>

  <table class="table">
    <thead>
      <tr>
        <th>Nombre</th><th>Contacto</th><th>Tipo</th>
        <th>Objetivo</th><th>Presupuesto</th><th>Máx compra</th>
        <th>Fase</th><th>Sub</th><th>Acciones</th>
      </tr>
    </thead>
    <tbody id="p_body"></tbody>
  </table>
</section>
</main>

<footer class="foot"><div class="container foot-inner">© 2025 Unihouser · unihouser.es · 644 300 200 · info@unihouser.es</div></footer>
<script defer src="js/app.js"></script>
<script defer src="js/prospectos.js"></script>
</body></html>
