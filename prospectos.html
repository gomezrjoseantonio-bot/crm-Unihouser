<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Unihouser — Prospectos</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
<header class="topbar">
  <div class="container flex between center">
    <div class="brand flex center"><div class="title">Unihouser — CRM & BuyBox</div></div>
    <nav class="nav">
      <a href="evaluar.html">Evaluar</a>
      <a href="evaluaciones.html">Evaluaciones</a>
      <a href="prospectos.html" class="active">Prospectos</a>
      <a href="dashboard.html">Dashboard</a>
      <a href="configuracion.html">Configuración</a>
    </nav>
  </div>
</header>

<main class="container">
  <section class="card">
    <h2>Prospectos</h2>

    <!-- barra de pasos -->
    <div id="steps" class="steps">
      <div class="step active" data-phase="F1"><span>F1</span> Contacto</div>
      <div class="step" data-phase="F2"><span>F2</span> Reunión</div>
      <div class="step" data-phase="F3"><span>F3</span> Búsqueda</div>
      <div class="step" data-phase="F4"><span>F4</span> Arras</div>
      <div class="step" data-phase="F5"><span>F5</span> Notaría</div>
    </div>

    <input type="hidden" id="p_idx" value="-1">
    <div id="p_toast" class="toast" hidden>OK</div>

    <!-- FASE 1 -->
    <div id="gateF1" class="section">
      <h3>Fase 1 — Contacto</h3>
      <div class="row three">
        <div class="field">
          <label>Nombre y apellidos</label>
          <input id="p_nombre" placeholder="Nombre Apellidos" autocomplete="name">
        </div>
        <div class="field">
          <label>Email</label>
          <input id="p_email" type="email" placeholder="nombre@dominio.com" autocomplete="email">
        </div>
        <div class="field">
          <label>Teléfono</label>
          <input id="p_tel" inputmode="tel" placeholder="644 300 200" autocomplete="tel">
        </div>
      </div>

      <div class="row two">
        <div class="field">
          <label>Subestado</label>
          <select id="p_sub_f1">
            <option>Contacto recibido</option>
            <option>Pendiente llamada</option>
            <option>Reunión agendada</option>
            <option>Descartado</option>
          </select>
        </div>
        <div class="field">
          <label>Recordatorio (nota)</label>
          <input id="p_recordatorio" placeholder="Llamar el lunes, etc.">
        </div>
      </div>

      <div class="actions">
        <button class="btn primary" id="p_save">Guardar</button>
        <button class="btn ghost" id="p_clear">Limpiar</button>
        <button class="btn" id="f1_email">Enviar email</button>
        <button class="btn" id="f1_pdf">Resumen PDF</button>
        <button class="btn" id="toF2">Ir a Fase 2</button>
      </div>
    </div>

    <!-- FASE 2 -->
    <div id="gateF2" class="section" hidden>
      <h3>Fase 2 — Reunión inicial</h3>

      <div class="row three">
        <div class="field"><label>DNI</label><input id="p_dni" placeholder="00000000X"></div>
        <div class="field"><label>Dirección</label><input id="p_dir" placeholder="C/ Dirección 1, 1ºA"></div>
        <div class="field"><label>Localidad (residencia)</label><input id="p_loc_res" placeholder="Oviedo"></div>
      </div>

      <div class="row three">
        <div class="field">
          <label>Tipo de alquiler</label>
          <select id="p_pref_tipo"><option>Tradicional</option><option>Habitaciones</option></select>
        </div>
        <div class="field">
          <label>Objetivo principal</label>
          <select id="p_obj_tipo">
            <option value="bruta">Rentabilidad bruta %</option>
            <option value="neta">Rentabilidad neta %</option>
            <option value="flujo">Flujo de caja €/año</option>
          </select>
        </div>
        <div class="field">
          <label>Valor objetivo</label>
          <input id="p_obj_val" placeholder="8,5 o 1.200">
        </div>
      </div>

      <div class="row three">
        <div class="field">
          <label>Presupuesto total inversión (€ con ITP/Notaría/Honor.)</label>
          <input id="p_budget" data-money placeholder="120.000">
        </div>
        <div class="field">
          <label>Incluir honorarios (PSI)</label>
          <select id="p_incl_honor"><option value="si">Sí</option><option value="no">No</option></select>
        </div>
        <div class="field">
          <label>Precio máx. compra (auto)</label>
          <input id="p_max_compra" data-money disabled>
        </div>
      </div>

      <div class="row one">
        <div class="field">
          <label>Localidades objetivo (separadas por coma)</label>
          <input id="p_locs_obj" placeholder="Oviedo, Gijón, Avilés">
        </div>
      </div>

      <div class="row three">
        <div class="field"><label>Nº de activos objetivo</label><input id="p_n_activos" inputmode="numeric" placeholder="2"></div>
        <div class="field"><label>Sin ascensor</label><select id="p_no_asc"><option value="no">No</option><option value="si">Sí</option></select></div>
        <div class="field"><label>Altura máxima</label><input id="p_alt_max" inputmode="numeric" placeholder="3"></div>
      </div>

      <div class="row three">
        <div class="field"><label>Bajos</label><select id="p_bajos"><option value="no">No</option><option value="si">Sí</option></select></div>
        <div class="field"><label>Acepta reforma</label>
          <select id="p_reforma"><option>No</option><option>Lavado de cara</option><option>Integral</option></select>
        </div>
        <div class="field"><label>Notas</label><input id="p_notes" placeholder="Preferencias, límites…"></div>
      </div>

      <div class="row two">
        <div class="field"><label>Mes inicio búsqueda</label><input id="p_inicio" type="month"></div>
        <div class="field"><label>Mes fin (máx +5 meses)</label><input id="p_fin" type="month"></div>
      </div>

      <div class="actions">
        <button class="btn primary" id="p_save_f2">Guardar</button>
        <button class="btn" id="f2_pdf">Resumen PDF</button>
        <button class="btn" id="f2_mail_ok">Enviar contrato</button>
        <button class="btn ghost" id="f2_mail_no">No interesa</button>
        <button class="btn" id="toF3">Ir a Fase 3</button>
        <button class="btn ghost" id="toF1">Volver Fase 1</button>
      </div>
    </div>

    <!-- FASE 3 -->
    <div id="gateF3" class="section" hidden>
      <h3>Fase 3 — Búsqueda y propuestas</h3>
      <div class="actions">
        <button class="btn" id="f3_enviar_props">Enviar propuestas</button>
        <button class="btn" id="f3_reserva">Reserva activa</button>
        <button class="btn" id="toF4">Ir a Fase 4</button>
        <button class="btn ghost" id="backF2">Volver Fase 2</button>
      </div>
    </div>

    <!-- FASE 4 -->
    <div id="gateF4" class="section" hidden>
      <h3>Fase 4 — Arras</h3>
      <div class="actions">
        <button class="btn" id="f4_pendientes">Arras pendientes</button>
        <button class="btn" id="f4_firmadas">Arras firmadas</button>
        <button class="btn" id="toF5">Ir a Fase 5</button>
        <button class="btn ghost" id="backF3">Volver Fase 3</button>
      </div>
    </div>

    <!-- FASE 5 -->
    <div id="gateF5" class="section" hidden>
      <h3>Fase 5 — Notaría</h3>
      <div class="row two">
        <div class="field"><label>Fecha notaría</label><input id="p_notaria_fecha" type="date"></div>
        <div class="field"><label>Subestado</label>
          <select id="p_sub_f5">
            <option>Notaría fijada</option>
            <option>Firmado</option>
            <option>Cancelado</option>
          </select>
        </div>
      </div>
      <div class="actions">
        <button class="btn primary" id="p_save_f5">Guardar</button>
        <button class="btn" id="f5_cerrar">Cerrar operación</button>
        <button class="btn ghost" id="backF4">Volver Fase 4</button>
      </div>
    </div>
  </section>

  <!-- GRID -->
  <section class="card">
    <h3>Listado de prospectos</h3>
    <div class="row three">
      <div class="field"><label>Filtrar por fase</label>
        <select id="f_fase">
          <option value="">Todas</option>
          <option>F1</option><option>F2</option><option>F3</option><option>F4</option><option>F5</option>
        </select>
      </div>
      <div class="field"><label>Tipo</label>
        <select id="f_tipo"><option value="">Todos</option><option>Tradicional</option><option>Habitaciones</option></select>
      </div>
      <div class="field"><label>Buscar</label><input id="f_q" placeholder="Nombre, email, localidad…"></div>
    </div>

    <table class="table">
      <thead>
        <tr>
          <th>Cliente</th><th>Contacto</th><th>Tipo</th><th>Objetivo</th>
          <th>Presupuesto</th><th>Máx. compra</th><th>Fase</th><th>Subestado</th><th>Acciones</th>
        </tr>
      </thead>
      <tbody id="p_body"></tbody>
    </table>
  </section>
</main>

<footer class="foot">
  <div class="container foot-inner">© 2025 Unihouser · unihouser.es · info@unihouser.es · 644 300 200</div>
</footer>

<script defer src="js/app.js"></script>
<script defer src="js/prospectos.js"></script>
</body>
</html>
